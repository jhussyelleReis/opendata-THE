<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Conjunto de Dados</title>
<script>
$(function() {
	$('.category').click(function(e){
		category = $(this).attr('href');
		pageurl = 'datasets?data={category:'+category+'}';
		$.ajax({url:pageurl,success: function(data){
			if(isJson(data)){
				results = jQuery.parseJSON(data);
				renderDatasets(results);
			}else {
				$('#content').load('pages/list_dataset.html', function(){//FIXME the server has to send always json as response
					$("#dataContainer").append(data); 
				});
			}
			
			if(pageurl!=window.location){
				window.history.pushState({path:'categoria/'+pageurl},'',pageurl);
			}
		}});
		return false;
	});
	
	$('.featured').click(function(e){//TODO refine the way this functionality is done.
		$.ajax({url:'/featured',success: function(data){
			var datasets = JSON.parse(data);
			for(var i=0; i < 1; i++){
					$.ajax({url:'/dataset?data={id:'+datasets[i].id+'}', success: function(result){//FIXME can throw: Uncaught TypeError: Cannot read property 'id' of undefined 
						$('#content').load('pages/show.html', function(){
							var table = handleFile(result);
							$('#showConteudoInter').append(table);
						});
					}});
			}
		}});
	});
	
	$('#btnSearch').click(function(e){
		var description = $('#textSearch').val();
		console.log(description);
		$.ajax({url:'/datasets?data={description:'+description+'}',success: function(data){
			if(isJson(data)){
				results = jQuery.parseJSON(data);
				renderDatasets(results);
			}else {
				$('#content').load('pages/list_dataset.html', function(){//FIXME the server has to send always json as response
					$("#dataContainer").append(data); 
				});
			}
		}});
	});
});
</script>
</head>
<body>
		<div id="frames">
			<div id="externalFrame">
        		<div id="featured1" class="featured">
	        		<img alt="Imagem no Frame 1" src="images/featured/featured1.png">
	        	</div>
	        	<div id="featured2" class="featured">
	        		<img alt="Imagem no Frame 2" src="images/featured/featured2.png" >
	        	</div>
	        	<div id="featured3" class="featured">
	        		<img alt="Imagem no Frame 3" src="images/featured/featured3.png">
	        	</div>
	        	<div id="featured4" class="featured">
	        		<img alt="Imagem no Frame 4" src="images/featured/featured4.png">
	        	</div>
        	</div>
        </div>
    
        <div id="searchBox">
        	<div id="divSearch">
        		<span class="fa fa-search fa-lg" style="float:left; margin:1% 1% 0 1%;" ></span>
        		<input type="text" id="textSearch" placeholder="Buscar..." />
        		<button id="btnSearch" value="search">Buscar</button>
           	</div>
        </div>
    
    
        <div id="container">
			    <div class=li>
			       	<a href="" style="text-decoration: none;" class="category">
			            <span class="fa fa-briefcase fa-5x" style="clear='both;'"></span>
			        	<div class="nameCategory">Negócios</div>
			        </a>
			    </div>
			
			    <div class=li>
			        <a href="" style="text-decoration: none;" class="category">
			            <span class="fa fa-leaf fa-5x" style="clear='both;'"></span>
			        	<div class="nameCategory">Ambientes</div>
			        </a>
			    </div>
			
			    <div class=li>
			    	<a href="" style="text-decoration: none;" class="category">
			    		<span class="fa fa-user-md fa-5x" style="clear='both;'"></span>
			    		<div class="nameCategory">Saúde</div>
			    	</a>
			    </div>
			    
			    <div class=li>
			    	<a href="" style="text-decoration: none;" class="category">
			    		<span class="fa fa-home fa-5x" style="clear='both;'"></span>
			    		<div class="nameCategory">Moradia</div>
			    	</a>
			    </div>
			    
			    <div class=li>
			    	<a href="" style="text-decoration: none;">
			    		<span class="fa fa-book fa-5x" style="clear='both;'"></span>
			    		<div class="nameCategory">Educação</div>
			    	</a>
			    </div>
			    
			    <div class=li>
			    	<a href="" style="text-decoration: none;">
			    		<span class="fa fa-gamepad fa-5x" style="clear='both;'"></span>
			    		<div class="nameCategory">Lazer</div>
			    	</a>
			    </div>
			    
			    <div class=li>
			    	<a href="transporte" style="text-decoration: none;" class="category">
			    		<span class="fa fa-truck fa-5x" style="clear='both;'" ></span>
			    		<div class="nameCategory">Transporte</div>
			    	</a>
			    </div>
			    
			    <div class=li>
			    	<a href="" style="text-decoration: none;">
			    	<span class="fa fa-users fa-5x" style="clear='both;'"></span>
			    	<div class="nameCategory">Serviço Social</div>
			    	</a>
			    </div>
		  
        </div>
		
</body>
</html>